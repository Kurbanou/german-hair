<?php

/**
 * Displays about consultation
 */


// Массив контактов
$about_contacts = [
  [
    'label' => get_phone_formated(get_theme_mod('main_contact_phone_setting', '')),
    'href'  => get_phone_href(get_theme_mod('main_contact_phone_setting', '')),
    'icon'  => '   <svg id="icon-phone" width="19" height="19" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M16.269 10.4287C16.0702 10.4287 15.8625 10.3653 15.6638 10.32C15.2613 10.2311 14.8659 10.1131 14.4805 9.96667C14.0615 9.81378 13.6009 9.82172 13.1874 9.98896C12.7738 10.1562 12.4366 10.4709 12.2405 10.8725L12.0418 11.2802C11.1622 10.7892 10.3538 10.1796 9.63916 9.46844C8.93008 8.75176 8.32226 7.94101 7.83268 7.05881L8.21204 6.80517C8.6125 6.60852 8.9263 6.27028 9.09305 5.85553C9.2598 5.44079 9.26772 4.97885 9.11528 4.5586C8.97101 4.17156 8.85331 3.77507 8.76301 3.37191C8.71785 3.17261 8.68172 2.96426 8.65463 2.75591C8.54494 2.11783 8.2117 1.54 7.71491 1.12646C7.21812 0.712929 6.59044 0.490874 5.9449 0.500287H3.23517C2.8459 0.496622 2.46041 0.577118 2.10495 0.736295C1.74949 0.895473 1.4324 1.12959 1.17526 1.42272C0.918127 1.71585 0.726986 2.0611 0.614852 2.43497C0.502718 2.80885 0.472222 3.20256 0.525442 3.58932C1.00663 7.38437 2.7348 10.9105 5.43696 13.6107C8.13912 16.3109 11.6613 18.0312 15.447 18.5H15.7902C16.4563 18.501 17.0994 18.2559 17.5967 17.8115C17.8825 17.5552 18.1108 17.241 18.2665 16.8896C18.4222 16.5383 18.5017 16.1578 18.5 15.7733V13.0557C18.4889 12.4265 18.2604 11.8206 17.8536 11.3415C17.4467 10.8624 16.8866 10.5397 16.269 10.4287ZM16.7206 15.8639C16.7204 15.9925 16.6929 16.1196 16.64 16.2368C16.587 16.3539 16.5098 16.4584 16.4135 16.5433C16.3129 16.6312 16.1949 16.6968 16.0672 16.7358C15.9396 16.7748 15.8052 16.7864 15.6728 16.7698C12.2901 16.3348 9.14801 14.7827 6.7422 12.3584C4.3364 9.93414 2.80379 6.77558 2.38612 3.38097C2.37227 3.2483 2.38512 3.11419 2.42391 2.98659C2.46269 2.85899 2.52663 2.7405 2.61193 2.63815C2.69658 2.54152 2.80077 2.46408 2.91757 2.41097C3.03438 2.35787 3.16112 2.33032 3.28936 2.33015H5.99909C6.20914 2.32546 6.41424 2.39436 6.5791 2.52498C6.74396 2.6556 6.85827 2.83977 6.90233 3.04579C6.93846 3.2934 6.98363 3.53798 7.03782 3.77955C7.14179 4.25717 7.28066 4.72647 7.45331 5.18365L6.18877 5.77247C6.08065 5.82222 5.9834 5.8929 5.90259 5.98046C5.82178 6.06801 5.75901 6.17071 5.71789 6.28266C5.67676 6.3946 5.65809 6.5136 5.66295 6.6328C5.6678 6.752 5.69609 6.86907 5.74618 6.97728C7.04677 9.76942 9.28486 12.014 12.0689 13.3184C12.2888 13.409 12.5354 13.409 12.7553 13.3184C12.868 13.278 12.9715 13.2155 13.0599 13.1347C13.1483 13.0538 13.2198 12.9561 13.2702 12.8473L13.8302 11.5791C14.2974 11.746 14.7739 11.8851 15.2573 11.9958C15.4982 12.0502 15.7421 12.0955 15.989 12.1317C16.1944 12.1759 16.378 12.2905 16.5083 12.4559C16.6385 12.6212 16.7072 12.8269 16.7025 13.0376L16.7206 15.8639Z" />
    </svg>',
  ],
  [
    'label' => get_theme_mod('main_contact_whatsapp_label_setting', ''),
    'href'  => get_theme_mod('main_contact_whatsapp_setting', ''),
    'icon'  => ' <svg id="icon-whats" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M18.3769 5.61904C17.5475 4.78574 16.5597 4.12502 15.4711 3.67537C14.3825 3.22573 13.2148 2.99616 12.0362 3.00005C7.09749 3.00005 3.07236 7.00504 3.07236 11.919C3.07236 13.494 3.48844 15.024 4.26633 16.374L3 21L7.74874 19.758C9.0603 20.469 10.5347 20.847 12.0362 20.847C16.9749 20.847 21 16.842 21 11.928C21 9.54303 20.0683 7.30204 18.3769 5.61904ZM12.0362 19.335C10.6975 19.335 9.38593 18.975 8.23719 18.3L7.96583 18.138L5.14372 18.876L5.89447 16.14L5.71357 15.861C4.96964 14.6794 4.57471 13.3134 4.57387 11.919C4.57387 7.83304 7.9206 4.50304 12.0271 4.50304C14.0171 4.50304 15.8894 5.27704 17.2915 6.68104C17.9858 7.36851 18.536 8.18632 18.9102 9.08703C19.2844 9.98773 19.4752 10.9534 19.4714 11.928C19.4894 16.014 16.1427 19.335 12.0362 19.335ZM16.1246 13.791C15.8985 13.683 14.795 13.143 14.596 13.062C14.3879 12.99 14.2432 12.954 14.0894 13.17C13.9357 13.395 13.5106 13.899 13.3839 14.043C13.2573 14.196 13.1216 14.214 12.8955 14.097C12.6693 13.989 11.9457 13.746 11.0955 12.99C10.4261 12.396 9.98291 11.667 9.84724 11.442C9.7206 11.217 9.82914 11.1 9.94673 10.983C10.0462 10.884 10.1729 10.722 10.2814 10.596C10.3899 10.47 10.4352 10.371 10.5075 10.227C10.5799 10.074 10.5437 9.94803 10.4894 9.84003C10.4352 9.73203 9.98291 8.63403 9.80201 8.18403C9.6211 7.75204 9.43116 7.80604 9.29548 7.79704H8.86131C8.70754 7.79704 8.47236 7.85104 8.26432 8.07604C8.06533 8.30103 7.48643 8.84103 7.48643 9.93903C7.48643 11.037 8.29146 12.099 8.4 12.243C8.50854 12.396 9.98291 14.646 12.2261 15.609C12.7598 15.843 13.1759 15.978 13.5015 16.077C14.0352 16.248 14.5236 16.221 14.9126 16.167C15.3467 16.104 16.2422 15.627 16.4231 15.105C16.6131 14.583 16.6131 14.142 16.5497 14.043C16.4864 13.944 16.3508 13.899 16.1246 13.791Z" />
    </svg>',
  ],
  [
    'label' => get_theme_mod('main_contact_address_setting', ''),
    'href'  => '',
    'icon'  => ' <svg  id="icon-map" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M8.526 3.10396C8.83369 3.00148 9.16631 3.00148 9.474 3.10396L15 4.94596L20.289 3.18296C20.4844 3.11785 20.6925 3.10009 20.896 3.13115C21.0996 3.16221 21.2929 3.24119 21.46 3.3616C21.6271 3.48201 21.7632 3.64039 21.8571 3.8237C21.951 4.00702 21.9999 4.21001 22 4.41596V17.64C22 17.9548 21.9009 18.2617 21.7167 18.5171C21.5326 18.7725 21.2727 18.9635 20.974 19.063L15.474 20.896C15.166 20.999 14.834 20.999 14.526 20.896L9 19.054L3.711 20.817C3.51561 20.8821 3.30755 20.8998 3.10395 20.8688C2.90036 20.8377 2.70705 20.7587 2.53997 20.6383C2.37288 20.5179 2.23679 20.3595 2.14291 20.1762C2.04903 19.9929 2.00005 19.7899 2 19.584V6.35996C2.00003 6.0451 2.09914 5.73823 2.28328 5.48283C2.46743 5.22743 2.72727 5.03646 3.026 4.93696L8.526 3.10396ZM8 17.28V5.38696L4 6.72096V18.613L8 17.279V17.28ZM10 5.38796V17.28L14 18.614V6.71996L10 5.38596V5.38796ZM16 6.72196V18.614L20 17.28V5.38696L16 6.72196Z" />
    </svg>',
  ],
];
?>

<section class="about-consultation">
  <div class="container">
    <h2 class="h2 text-second-dark">Записаться на консультацию</h2>

    <div>
      <div class="about-contacts">

        <?php foreach ($about_contacts as $contact): ?>
          <?php
          $label = trim(strip_tags($contact['label'] ?? ''));
          $href  = trim($contact['href'] ?? '');
          $icon  = $contact['icon'] ?? '';

          // Пропускаем, если нет label и нет href
          if ($label === '' && $href === '') {
            continue;
          }

          // Обработка только для WhatsApp (второй элемент массива)
          if (isset($contact['icon']) && strpos($contact['icon'], 'icon-whats') !== false) {
            $href = get_whatsapp_link($href);
          }

          // Если нет href, используем <div>
          $tag = $href ? 'a' : 'div';
          $tag_attrs = $href ? 'href="' . esc_url($href) . '" target="_blank" rel="noopener"' : '';
          ?>
          <<?= $tag ?> class="about-contacts-item" <?= $tag_attrs ?>>
            <?php if ($icon): ?>
              <div class="icon"><?= $icon ?></div>
            <?php endif; ?>
            <?php if ($label): ?>
              <div class="label"><?= esc_html($label) ?></div>
            <?php endif; ?>
          </<?= $tag ?>>
        <?php endforeach; ?>

      </div>
      <button class="btn btn-light btn-glowing">Оставить заявку</button>
    </div>
  </div>

  <div class="section-bg-mobile">
    <svg width="480" height="39" viewBox="0 0 480 39" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 38.1337C0 38.1337 93.7182 8.95032 156.553 4.93666C205.08 1.837 233.081 3.47895 280.971 10.8244C319.616 16.752 343.957 25.7308 383.746 27.8269C420.678 29.7726 453.198 9.62276 480 0.702148" stroke="#967866" stroke-opacity="0.2" />
      <rect x="51" y="13.6221" width="16" height="16" rx="8" fill="#EAE4E0" />
    </svg>
  </div>
</section>